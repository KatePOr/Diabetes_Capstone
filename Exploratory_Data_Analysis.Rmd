---
title: "Exploratory Data Analysis"
author: "Kate O'Rourke"
date: "2024-11-14"
output: pdf_document
---

# Exploratory Data Analysis

## Read in dataset
```{r}
library(readr)
CDC_2023_subset <- read_csv("CDC_2023_cleaned.csv")
```

## Remove first blank column
```{r}
CDC_2023_subset = subset(CDC_2023_subset, select = -c(1, 5:6, 22, 23) )
```

## Libraries for data visualizations and tables
```{r}
library(ggplot2)
library(dplyr)
library(scales)
library(ggbeeswarm)
library(treemap)
library(plotly)
library(gtsummary)
library(stringr)
```

### Convert columns (except for BMI) to factors
```{r}
col_names <- colnames(CDC_2023_subset)
col_names <- col_names[-19] # Column 19 (BMI)
CDC_2023_subset[,col_names] <- lapply(CDC_2023_subset[,col_names] , factor)
```

## Get columns proportions for factor data after data cleaning

### Column proportion summaries
```{r}
CDC_2023_subset %>%
  tbl_summary()
```

### EDUCA summary
```{r}
# Proportion summary
table <- table(CDC_2023_subset$EDUCA, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=EDUCA, fill=EDUCA, color=EDUCA)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=EDUCA, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0.25, size=3)
```

### EMPLOY1 summary (1:employed, 2: out of labor force, 3: unemployed)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$EMPLOY1, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=EMPLOY1, fill=EMPLOY1)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=EMPLOY1, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0.25, size=3)
```

### INCOME3 summary
```{r}
# Proportion summary
table <- table(CDC_2023_subset$INCOME3, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=INCOME3, fill=INCOME3)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=INCOME3, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0.25, size=3)
```

### SEXVAR summary (1:male, 2:female)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$SEXVAR, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=SEXVAR, fill=SEXVAR)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=SEXVAR, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0.25, size=3)
```

### PHYSHLTH summary (0: 0 days of bad health, 1: 1-13 days of bad health, 2: 14+ days of bad health)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$PHYSHLTH, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=PHYSHLTH, fill=PHYSHLTH)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=PHYSHLTH, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0.25, size=3)
```

### MENTHLTH summary (0: 0 days of bad health, 1: 1-13 days of bad health, 2: 14+ days of bad health)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$MENTHLTH, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=MENTHLTH, fill=MENTHLTH)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=MENTHLTH, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0.25, size=3)
```

### PERSDOC3 summary (1: 1 or more personal doctors, 2: none)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$PERSDOC3, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=PERSDOC3, fill=PERSDOC3)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=PERSDOC3, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0.25, size=3)
```

### MEDCOST1 summary (1: med cost too high in last 12 months, 2: not)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$MEDCOST1, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=MEDCOST1, fill=MEDCOST1)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=MEDCOST1, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0.25, size=3)
```

### SMOKE100 summary (1: smoked at least 100 cigarettes, 2: has not smoked more than 100 cigarettes)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$SMOKE100, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=SMOKE100, fill=SMOKE100)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=SMOKE100, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0.25, size=3)
```

### DRNK3GE5 summary (0: No binge drinking in last 30 days, 1: yes, binge drinking in last 30 days)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$DRNK3GE5, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=DRNK3GE5, fill=DRNK3GE5)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=DRNK3GE5, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0.25, size=3)
```

### EXERANY2 summary (1: yes,physical activity in last 30 days, 2: no physical activity in last 30 days)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$EXERANY2, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=EXERANY2, fill=EXERANY2)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=EXERANY2, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0.25, size=3)
```

### BPHIGH6 summary (1: Told BP high, 2: BP high in pregnancy, 3: Not high, 4: borderline or pre-hypertenisve or elevated BP)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$BPHIGH6, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=BPHIGH6, fill=BPHIGH6)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=BPHIGH6, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0.25, size=3)
```

### TOLDHI3 summary (1: high cholesterol, 2: not high)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$TOLDHI3, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=TOLDHI3, fill=TOLDHI3)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=TOLDHI3, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0, size=3)
```

### CVDINFR4 summary (1: had heart attack, 2: no heart attack)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$CVDINFR4, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=CVDINFR4, fill=CVDINFR4)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=CVDINFR4, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0, size=3)
```

### CVDCRHD4 summary (1: angina or coronary heart disease, 2: no)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$CVDCRHD4, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=CVDCRHD4, fill=CVDCRHD4)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=CVDCRHD4, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0, size=3)
```

### CVDSTRK3 summary (1: had a stroke, 2: no)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$CVDSTRK3, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph overall
ggplot(CDC_2023_subset, aes(x=CVDSTRK3, fill=CVDSTRK3)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=CVDSTRK3, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0, size=3)
```

### CHCKDNY2 summary (1: had kidney disease, 2: no)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$CHCKDNY2, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph
ggplot(CDC_2023_subset, aes(x=CHCKDNY2, fill=CHCKDNY2)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)

# Bar graph by diabetes
CDC_2023_subset %>% 
  group_by(DIABETE4) %>%
  ggplot(aes(x=CHCKDNY2, fill=DIABETE4)) + 
    geom_bar() + 
    scale_y_continuous(labels = scales::comma) +
    geom_text(stat='count', aes(label=..count..), vjust = 0, size=3)
```

### Diabetes summary (0: does not have diabetes, 1: has type 2 diabetes or prediabetes or borderline diabetes)
```{r}
# Proportion summary
table <- table(CDC_2023_subset$DIABETE4, useNA = "ifany")
prop.table(table) %>% {. * 100} %>% round(4)

# Bar graph
ggplot(CDC_2023_subset, aes(x=DIABETE4, fill=DIABETE4)) + 
  geom_bar() + 
  scale_y_continuous(labels = scales::comma)
```

## Compare Diabetes and Exercise to Determine the Impact on Type 2 Diabetes
```{r}
# Convert DIABETE4 and EXERANY2 to correct types
CDC_2023_subset$EXERANY2 <- as.factor(CDC_2023_subset$EXERANY2)
CDC_2023_subset$DIABETE4 <- as.numeric(as.character(CDC_2023_subset$DIABETE4))

# Filter out inappropriate data
CDC_2023_subset <- CDC_2023_subset %>%
  filter(EXERANY2 %in% c("1", "2"), !is.na(DIABETE4), !is.na(BMI))

# Categorize BMI into groups
CDC_2023_subset <- CDC_2023_subset %>%
  mutate(BMI_Category = case_when(
    BMI < 18.5 ~ "Underweight",
    BMI >= 18.5 & BMI < 25 ~ "Normal weight",
    BMI >= 25 & BMI < 30 ~ "Overweight",
    BMI >= 30 ~ "Obese"
  ))

# Calculate the prevalence of diabetes by exercise and BMI category
exercise_bmi_diabetes_data <- CDC_2023_subset %>%
  group_by(EXERANY2, BMI_Category) %>%
  summarise(Diabetes_Prevalence = mean(DIABETE4 == 1, na.rm = TRUE),
            .groups = 'drop') %>%
  mutate(Exercise = ifelse(EXERANY2 == "1", "Yes", "No"))

# Create the bar plot with BMI categories
ggplot(exercise_bmi_diabetes_data, aes(x = Exercise, y = Diabetes_Prevalence, fill = BMI_Category)) +
  geom_bar(stat = "identity", position = position_dodge()) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
  labs(title = "Prevalence of Diabetes by Exercise and BMI Category",
       x = "Regular Exercise",
      
)
```

### Convert DIABETE4 back to factor
```{r}
CDC_2023_subset$DIABETE4 <- as.factor(CDC_2023_subset$DIABETE4)
```

## Measures of central tendencies, spread, and measures of distribution shape (skew and kurtosis) and histogram for all and type 2 diabetes within BMI
```{r}
# Summary of BMI column
library(moments)
print(summary(CDC_2023_subset$BMI))
cat("Skewness is ", skewness(CDC_2023_subset$BMI), ". ")
cat("Kurtosis is ", kurtosis(CDC_2023_subset$BMI), ".")

# Histogram 
BMI_summ1 <- CDC_2023_subset %>% summarize(mean = mean(BMI), median = median(BMI)) #Calculate mean for graph
BMI_over_75 <- filter(CDC_2023_subset, BMI>75)
outliers <- data.frame(x = BMI_over_75$BMI, y = 0)
ggplot(data = CDC_2023_subset, aes(x = BMI)) +
  geom_histogram(aes(y= ..density..), binwidth = 0.5, fill="grey") +
  geom_density(linewidth = 0.7) +
  geom_vline(aes(xintercept = mean), BMI_summ1, color = "red", linewidth = 0.7) +
  geom_vline(aes(xintercept = median), BMI_summ1, color = "blue", linewidth = 0.7) + 
  xlab("BMI") +
  ylab("Density") + 
  labs(title="Density Plot of BMI") + 
  theme_bw()+
  theme(plot.title = element_text(hjust = 0.5)) +
  geom_point(data = outliers, aes(x, y), height = 0.1) +
  scale_x_continuous(breaks=c(0,30,60,90,120)) +
  xlim(0,120) 

BMI_summ2 <- CDC_2023_subset %>% filter(DIABETE4 == 1) %>% summarize(mean = mean(BMI), median = median(BMI)) #Calculate mean for graph

BMI_diab <- CDC_2023_subset %>%
  filter(DIABETE4 == 1) 
ggplot(data=BMI_diab, aes(x = BMI)) +
    geom_histogram(aes(y= ..density..), binwidth = 0.5, fill="grey") +
    geom_density(linewidth = 0.7) +
    geom_vline(aes(xintercept = mean), BMI_summ2, color = "red", linewidth = 0.7) +
    geom_vline(aes(xintercept = median), BMI_summ2, color = "blue", linewidth = 0.7) + 
    xlab("BMI") +
    ylab("Density") + 
    labs(title="Density Plot of BMI for Type 2 Diabetics") + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    scale_x_continuous(breaks=c(0,30,60,90,120)) +
    xlim(0,120) 
```

## Proportion tables split by social factors, demographic characteristics, and health conditions

### Change column names for simpler axes and legends
```{r}
colnames(CDC_2023_subset) <- c("Education", "Employment_Status", "Income", "Sex", "Physical_Health", "Mental_Health", "Personal_Doctor", "Not_Afford_Doctor", "Smoked_100_Pkgs", "Binge_Drinking", "Exercised", "HighBP", "High_Cholesterol", "Myocardial_Infarction", "Heart_Disease", "Stroke", "Kidney_Disease", "Type_2_Diabetes", "BMI", "BMI_Category")
```

### Proportion tables for each of the categories (Social Factors, Demographics, and Diseases) split by type 2 diabetes
```{r}
# Social factors
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Physical_Health = str_replace(Physical_Health, "0", "0 Days")) %>%
  mutate(Physical_Health = str_replace(Physical_Health, "1", "1 -13 Days")) %>%
  mutate(Physical_Health = str_replace(Physical_Health, "2", "14+ Days")) %>%
  mutate(Mental_Health = str_replace(Mental_Health, "0", "0 Days")) %>%
  mutate(Mental_Health = str_replace(Mental_Health, "1", "1 -13 Days")) %>%
  mutate(Mental_Health = str_replace(Mental_Health, "2", "14+ Days")) %>%
  mutate(Personal_Doctor = str_replace(Personal_Doctor, "1", "More than one")) %>%
  mutate(Personal_Doctor = str_replace(Personal_Doctor, "2", "No")) %>%
  mutate(Not_Afford_Doctor = str_replace(Not_Afford_Doctor, "1", "Yes")) %>%
  mutate(Not_Afford_Doctor = str_replace(Not_Afford_Doctor, "2", "No")) %>%
  mutate(Smoked_100_Pkgs = str_replace(Smoked_100_Pkgs, "1", "Yes")) %>%
  mutate(Smoked_100_Pkgs = str_replace(Smoked_100_Pkgs, "2", "No")) %>%
  mutate(Binge_Drinking = str_replace(Binge_Drinking, "1", "Yes")) %>%
  mutate(Binge_Drinking = str_replace(Binge_Drinking, "0", "No")) %>%
  mutate(Exercised = str_replace(Exercised, "1", "Yes")) %>%
  mutate(Exercised = str_replace(Exercised, "2", "No")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "0", "No Diabetes")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "1", "Type 2 Diabetes")) %>%
  # Create proportion table
  tbl_summary(
    include = c(Physical_Health, Mental_Health, Personal_Doctor, Not_Afford_Doctor, Smoked_100_Pkgs, Binge_Drinking, Exercised),
    by = Type_2_Diabetes,
    missing = 'no',
    type = all_dichotomous() ~ "categorical"
  ) |>
  add_n() |>
  modify_header()

# Demographic characteristics
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Employment_Status = str_replace(Employment_Status, "1", "Employed")) %>%
  mutate(Employment_Status = str_replace(Employment_Status, "2", "Out of Labor Force")) %>%
  mutate(Employment_Status = str_replace(Employment_Status, "3", "Unemployed")) %>%
  mutate(Sex = str_replace(Sex, "1", "Male")) %>%
  mutate(Sex = str_replace(Sex, "2", "Female")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "0", "No Diabetes")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "1", "Type 2 Diabetes")) %>%
  # Create proportion table
  tbl_summary(
    include = c(Education, Employment_Status, Income, Sex, BMI),
    by = Type_2_Diabetes,
    missing = 'no',
    type = all_dichotomous() ~ "categorical"
  ) |>
  add_n() |>
  modify_header()

# Health conditions
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "0", "No Diabetes")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "1", "Type 2 Diabetes")) %>%
  mutate(HighBP = str_replace(HighBP, "1", "Yes")) %>%
  mutate(HighBP = str_replace(HighBP, "2", "No")) %>%
  mutate(High_Cholesterol = str_replace(High_Cholesterol, "1", "Yes")) %>%
  mutate(High_Cholesterol = str_replace(High_Cholesterol, "2", "No")) %>%
  mutate(Myocardial_Infarction = str_replace(Myocardial_Infarction, "1", "Yes")) %>%
  mutate(Myocardial_Infarction = str_replace(Myocardial_Infarction, "2", "No")) %>%
  mutate(Heart_Disease = str_replace(Heart_Disease, "1", "Yes")) %>%
  mutate(Heart_Disease = str_replace(Heart_Disease, "2", "No")) %>%
  mutate(Stroke = str_replace(Stroke, "1", "Yes")) %>%
  mutate(Stroke = str_replace(Stroke, "2", "No")) %>%
  mutate(Kidney_Disease = str_replace(Kidney_Disease, "1", "Yes")) %>%
  mutate(Kidney_Disease = str_replace(Kidney_Disease, "2", "No")) %>%
  # Create proportion table
  tbl_summary(
    include = c(HighBP, High_Cholesterol, Myocardial_Infarction, Heart_Disease, Stroke, Kidney_Disease),
    by = Type_2_Diabetes,
    type = all_dichotomous() ~ "categorical"
  ) |>
  add_n() |>
  modify_header()
```

## Comparing BMI with Education, Income, Employment, Ability to afford doctor, and Type 2 diabetes
### Quasi random plot shown to illustrate Education vs BMI in a violin plot format
```{r}
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  ggplot() +
    aes(y = BMI, x = Education) +
    geom_quasirandom(aes()) +
    ylab("BMI") +
    xlab("Education Level") + 
    labs(title="Impact of Education on BMI") + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()
```


### Quasi random plot shown to illustrate Income vs BMI in a violin plot format
```{r}
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Income = str_replace(Income, "1", "Less than $10,000")) %>%
  mutate(Income = str_replace(Income, "2", "$10,000 to <$15,000")) %>%
  mutate(Income = str_replace(Income, "3", "$15,000 to <$20,000")) %>%
  mutate(Income = str_replace(Income, "4", "$20,000 to <$25,000")) %>%
  mutate(Income = str_replace(Income, "5", "$25,000 to <$35,000")) %>%
  mutate(Income = str_replace(Income, "6", "$35,000 to <$50,000")) %>%
  mutate(Income = str_replace(Income, "7", "$50,000 to <$75,000")) %>%
  mutate(Income = str_replace(Income, "8", "$75,000 to < $100,000")) %>%
  mutate(Income = str_replace(Income, "9", "$100,000 to <$150,000")) %>%
  mutate(Income = str_replace(Income, "10", "$150,000 to <$200,000")) %>%
  mutate(Income = str_replace(Income, "11", "$200,000 or more")) %>%
  mutate(Income = as.factor(Income)) %>%
  ggplot(aes(y = BMI, x = Income)) +
    geom_quasirandom(aes(y = BMI, x = Income)) +
    ylab("BMI") +
    xlab("Income Level") + 
    labs(title="Impact of Income Level on BMI") + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()
```


### Quasi random plot shown to illustrate Employment_Status vs BMI in a violin plot format
```{r}
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Employment_Status = str_replace(Employment_Status, "1", "Employed")) %>%
  mutate(Employment_Status = str_replace(Employment_Status, "2", "Out of Labor Force")) %>%
  mutate(Employment_Status = str_replace(Employment_Status, "3", "Unemployed")) %>%
  ggplot(aes(y = BMI, x = Employment_Status)) +
    geom_quasirandom(aes(y = BMI, x = Employment_Status)) +
    ylab("BMI") +
    xlab("Employment Status") + 
    labs(title="Impact of Employment Status on BMI") + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()
```


### Quasi random plot shown to illustrate Not_Afford_Doctor vs BMI in a violin plot format
```{r}
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Not_Afford_Doctor = str_replace(Not_Afford_Doctor, "1", "Yes")) %>%
  mutate(Not_Afford_Doctor = str_replace(Not_Afford_Doctor, "2", "No")) %>%
  ggplot(aes(y = BMI, x = Not_Afford_Doctor)) +
    geom_quasirandom(aes()) +
    ylab("Was individual unable to afford a doctor in the last 12 months?") +
    xlab("BMI") + 
    labs(title="Impact of Ability to Afford Doctor on BMI") + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()
```


### Quasi random plot shown to illustrate Type_2_Diabetes vs BMI in a violin plot format
```{r}
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "0", "No Diabetes")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "1", "Type 2 Diabetes")) %>%
  ggplot() +
    aes(y = BMI, x = Type_2_Diabetes) +
    geom_quasirandom(aes()) +
    xlab("Does the individual have type 2 diabetes?") +
    ylab("BMI") + 
    labs(title="Relationship Between Type 2 Diabetes and BMI") + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()
```

## Compare education with diseases

### Compare Education with Type_2_Diabetes using bar plots (stacked bar for overall numbers and fill bar plots for proportions)
```{r}
# Stacked Bar Plot
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "0", "No Diabetes")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "1", "Type 2 Diabetes")) %>%
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  ggplot(aes(fill = Type_2_Diabetes, x = Education)) + 
    geom_bar(position="stack") +
    ylab("Count") +
    xlab("Education Level") + 
    labs(title="Education Level Distribution and Proportion of Type 2 Diabetes") + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()

# Fill bar plot
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "0", "No Diabetes")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "1", "Type 2 Diabetes")) %>%
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  ggplot(aes(fill = Type_2_Diabetes, x = Education)) + 
    geom_bar(position="fill") +
    ylab("Proportion") +
    xlab("Education Level") + 
    labs(title="Education Level Distribution and Proportion of Type 2 Diabetes") + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()
```

### Compare Education with HighBP using bar plots (stacked bar for overall numbers and fill bar plots for proportions)
```{r}
# Stacked bar plot
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(HighBP = str_replace(HighBP, "1", "Yes")) %>%
  mutate(HighBP = str_replace(HighBP, "2", "No")) %>%
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  ggplot(aes(fill = HighBP, x = Education)) + 
    geom_bar(position="stack") +
    ylab("Count") +
    xlab("Education") + 
    labs(title=str_wrap("Education Level Distribution and Proportion of Individuals with High Blood Pressure")) + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()

# Fill bar plot
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(HighBP = str_replace(HighBP, "1", "Yes")) %>%
  mutate(HighBP = str_replace(HighBP, "2", "No")) %>%
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  ggplot(aes(fill = HighBP, x = Education)) + 
    geom_bar(position="fill") +
    ylab("Proportion") +
    xlab("Education") + 
    labs(title=str_wrap("Education Level Distribution and Proportion of Individuals with High Blood Pressure")) + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()
```

### Compare Education with High_Cholesterol using bar plots (stacked bar for overall numbers and fill bar plots for proportions)
```{r}
# Stacked bar plot
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  mutate(High_Cholesterol = str_replace(High_Cholesterol, "1", "Yes")) %>%
  mutate(High_Cholesterol = str_replace(High_Cholesterol, "2", "No")) %>%
  ggplot(aes(fill = High_Cholesterol, x = Education)) + 
    geom_bar(position="stack") +
    ylab("Count") +
    xlab("Education") + 
    labs(title=str_wrap("Education Level Distribution and Proportion of Individuals with High Cholesterol")) + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()

# Fill bar plot
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  mutate(High_Cholesterol = str_replace(High_Cholesterol, "1", "Yes")) %>%
  mutate(High_Cholesterol = str_replace(High_Cholesterol, "2", "No")) %>%
  ggplot(aes(fill = High_Cholesterol, x = Education)) + 
    geom_bar(position="fill") +
    ylab("Proportion") +
    xlab("Education") + 
    labs(title=str_wrap("Education Level Distribution and Proportion of Individuals with High Cholesterol")) + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()
```

### Compare Education with Myocardial_Infarction using bar plots (stacked bar for overall numbers and fill bar plots for proportions)
```{r}
# Stacked bar plot
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  mutate(Myocardial_Infarction = str_replace(Myocardial_Infarction, "1", "Yes")) %>%
  mutate(Myocardial_Infarction = str_replace(Myocardial_Infarction, "2", "No")) %>%
  ggplot(aes(fill = Myocardial_Infarction, x = Education)) + 
    geom_bar(position="stack") +
    ylab("Count") +
    xlab("Education") + 
    labs(title=str_wrap("Education Level Distribution and Proportion of Individuals with Myocardial Infarction")) + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()

# Fill bar plot
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  mutate(Myocardial_Infarction = str_replace(Myocardial_Infarction, "1", "Yes")) %>%
  mutate(Myocardial_Infarction = str_replace(Myocardial_Infarction, "2", "No")) %>%
  ggplot(aes(fill = Myocardial_Infarction, x = Education)) + 
    geom_bar(position="fill") +
    ylab("Proportion") +
    xlab("Education") + 
    labs(title=str_wrap("Education Level Distribution and Proportion of Individuals with Myocardial Infarction")) + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()
```


### Compare Education with Heart_Disease using bar plots (stacked bar for overall numbers and fill bar plots for proportions)
```{r}
# Stacked bar plot
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  mutate(Heart_Disease = str_replace(Heart_Disease, "1", "Yes")) %>%
  mutate(Heart_Disease = str_replace(Heart_Disease, "2", "No")) %>%
  ggplot(aes(fill = Heart_Disease, x = Education)) + 
    geom_bar(position="stack") +
    ylab("Count") +
    xlab("Education") + 
    labs(title=str_wrap("Education Level Distribution and Proportion of Individuals with Heart Disease")) + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()

# Fill bar plot
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  mutate(Heart_Disease = str_replace(Heart_Disease, "1", "Yes")) %>%
  mutate(Heart_Disease = str_replace(Heart_Disease, "2", "No")) %>%
  ggplot(aes(fill = Heart_Disease, x = Education)) + 
    geom_bar(position="fill") +
    ylab("Proportion") +
    xlab("Education") + 
    labs(title=str_wrap("Education Level Distribution and Proportion of Individuals with Heart Disease")) + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()
```

### Compare Education with Stroke using bar plots (stacked bar for overall numbers and fill bar plots for proportions)
```{r}
# Stacked bar plot
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Stroke = str_replace(Stroke, "1", "Yes")) %>%
  mutate(Stroke = str_replace(Stroke, "2", "No")) %>%
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  ggplot(aes(fill = Stroke, x = Education)) + 
    geom_bar(position="stack") +
    ylab("Count") +
    xlab("Education") + 
    labs(title=str_wrap("Education Level Distribution and Proportion of Individuals with Stroke")) + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()

# Fill bar plot
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Stroke = str_replace(Stroke, "1", "Yes")) %>%
  mutate(Stroke = str_replace(Stroke, "2", "No")) %>%
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  ggplot(aes(fill = Stroke, x = Education)) + 
    geom_bar(position="fill") +
    ylab("Proportion") +
    xlab("Education") + 
    labs(title=str_wrap("Education Level Distribution and Proportion of Individuals with Stroke")) + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()
```

### Compare Education with Kidney_Disease using bar plots (stacked bar for overall numbers and fill bar plots for proportions)
```{r}
# Stacked bar plot
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Kidney_Disease = str_replace(Kidney_Disease, "1", "Yes")) %>%
  mutate(Kidney_Disease = str_replace(Kidney_Disease, "2", "No")) %>%
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  ggplot(aes(fill = Kidney_Disease, x = Education)) + 
    geom_bar(position="stack") +
    ylab("Count") +
    xlab("Education") + 
    labs(title=str_wrap("Education Level Distribution and Proportion of Individuals with Kidney Disease")) + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()

# Fill bar plot
CDC_2023_subset %>%
  # Rename variables to simplify axes and legends
  mutate(Kidney_Disease = str_replace(Kidney_Disease, "1", "Yes")) %>%
  mutate(Kidney_Disease = str_replace(Kidney_Disease, "2", "No")) %>%
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  ggplot(aes(fill = Kidney_Disease, x = Education)) + 
    geom_bar(position="fill") +
    ylab("Proportion") +
    xlab("Education") + 
    labs(title=str_wrap("Education Level Distribution and Proportion of Individuals with Kidney Disease")) + 
    theme_bw()+
    theme(plot.title = element_text(hjust = 0.5)) +
    coord_flip()
```

### Heatmap for Correlation

#### Disease
```{r}
library(ggcorrplot)
# Select diseases columns
subset <- CDC_2023_subset %>%
  select(HighBP, High_Cholesterol, Myocardial_Infarction, Heart_Disease, Stroke, Kidney_Disease, Type_2_Diabetes) 
# Create heat map
model.matrix(~0+., data=subset) %>% 
  cor(use="pairwise.complete.obs") %>% 
  ggcorrplot(show.diag=FALSE, type="lower", lab=TRUE, lab_size=2)
```

#### Social Factors
```{r}
# Select social factors columns
subset <- CDC_2023_subset %>%
  select(Physical_Health, Mental_Health, Personal_Doctor, Not_Afford_Doctor, Smoked_100_Pkgs, Binge_Drinking, Exercised) 
# Create heat map
model.matrix(~0+., data=subset) %>% 
  cor(use="pairwise.complete.obs") %>% 
  ggcorrplot(show.diag=FALSE, type="lower", lab=TRUE, lab_size=2)
```

#### Demographics
```{r}
# Select demographics variables
subset <- CDC_2023_subset %>%
  select(Education, Employment_Status, Income, Sex, BMI) 
# Create heat map
model.matrix(~0+., data=subset) %>% 
  cor(use="pairwise.complete.obs") %>% 
  ggcorrplot(show.diag=FALSE, type="lower", lab=TRUE, lab_size=2)
```

## Plots to compare relationship between Demographic Variables
### Different size dots for different counts (use to see if there is a relationship between the two variables)

### Comapre Employment_Status, Education, and Sex
```{r}
df_summary <- CDC_2023_subset %>%                                                                 
  group_by(Education, Employment_Status, Sex) %>%
  # Rename variables to simplify axes and legends
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  mutate(Employment_Status = str_replace(Employment_Status, "1", "Employed")) %>%
  mutate(Employment_Status = str_replace(Employment_Status, "2", "Out of Labor Force")) %>%
  mutate(Employment_Status = str_replace(Employment_Status, "3", "Unemployed")) %>%
  mutate(Income = str_replace(Income, "1", "Less than $10,000")) %>%
  mutate(Income = str_replace(Income, "2", "$10,000 to <$15,000")) %>%
  mutate(Income = str_replace(Income, "3", "$15,000 to <$20,000")) %>%
  mutate(Income = str_replace(Income, "4", "$20,000 to <$25,000")) %>%
  mutate(Income = str_replace(Income, "5", "$25,000 to <$35,000")) %>%
  mutate(Income = str_replace(Income, "6", "$35,000 to <$50,000")) %>%
  mutate(Income = str_replace(Income, "7", "$50,000 to <$75,000")) %>%
  mutate(Income = str_replace(Income, "8", "$75,000 to < $100,000")) %>%
  mutate(Income = str_replace(Income, "9", "$100,000 to <$150,000")) %>%
  mutate(Income = str_replace(Income, "10", "$150,000 to <$200,000")) %>%
  mutate(Income = str_replace(Income, "11", "$200,000 or more")) %>%
  mutate(Sex = str_replace(Sex, "1", "Male")) %>%
  mutate(Sex = str_replace(Sex, "2", "Female")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "0", "No Diabetes")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "1", "Type 2 Diabetes")) %>%
  mutate(Count = n()) 
# Create plot comparing Education, Sex, and Employment Status
ggplot(df_summary, aes(x = Education, y = Employment_Status, size=Count, color=Count)) +             
  geom_point() +
  facet_wrap(~Sex) +
  coord_flip() + 
  ylab("Employment Status") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Comapre Income, Education, and Sex
```{r}
df_summary <- CDC_2023_subset %>%                                                                 
  group_by(Education, Income, Sex) %>%
  mutate(Count = n()) %>%
  # Rename variables to simplify axes and legends
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  mutate(Sex = str_replace(Sex, "1", "Male")) %>%
  mutate(Sex = str_replace(Sex, "2", "Female")) %>%
  summarise(Count = n())
# Create plot comparing Education, Sex, and Income
ggplot(df_summary, aes(x = Education, y = Income, size=Count, color=Count)) +             
  geom_point() +
  facet_wrap(~Sex) +
  coord_flip() + 
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

## Plots to compare relationship between Demographic and Social Factors Variables
### Different size dots for different counts (use to see if there is a relationship between the two variables)

### Comapre Mental_Health, Education, and Sex
```{r}
df_summary <- CDC_2023_subset %>%                                                                 
  group_by(Education, Mental_Health, Sex) %>%
  # Rename variables to simplify axes and legends
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  mutate(Mental_Health = str_replace(Mental_Health, "0", "0 days")) %>%
  mutate(Mental_Health = str_replace(Mental_Health, "1", "0-13 days")) %>%
  mutate(Mental_Health = str_replace(Mental_Health, "2", "14+ days")) %>%
  mutate(Mental_Health = factor(Mental_Health, levels=c("0 days", "0-13 days", "14+ days"))) %>%
  mutate(Sex = str_replace(Sex, "1", "Male")) %>%
  mutate(Sex = str_replace(Sex, "2", "Female")) %>%
  mutate(Count = n())
# Create plot comparing Education, Sex, and Mental_Health
ggplot(df_summary, aes(x = Education, y = Mental_Health, size=Count, color=Count)) +             
  geom_point() +
  facet_wrap(~Sex) +
  coord_flip() + 
  ylab("Days with Poor Mental Health") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Comapre Not_Afford_Doctor, Education, and Sex
```{r}
df_summary <- CDC_2023_subset %>%                                                                 
  group_by(Education, Not_Afford_Doctor, Sex) %>%
  # Rename variables to simplify axes and legends
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  mutate(Not_Afford_Doctor = str_replace(Not_Afford_Doctor, "1", "Yes")) %>%
  mutate(Not_Afford_Doctor = str_replace(Not_Afford_Doctor, "2", "No")) %>%
  mutate(Sex = str_replace(Sex, "1", "Male")) %>%
  mutate(Sex = str_replace(Sex, "2", "Female")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "0", "No Diabetes")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "1", "Type 2 Diabetes")) %>%
  mutate(Count = n())
# Create plot comparing Education, Sex, and Not_Afford_Doctor
ggplot(df_summary, aes(x = Education, y = Not_Afford_Doctor, size=Count, color=Count)) +             
  geom_point() +
  facet_wrap(~Sex) +
  coord_flip() + 
  ylab("Days with Poor Mental Health") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Compare Physical_Health, Education, and Sex
```{r}
df_summary <- CDC_2023_subset %>%                                                                 
  group_by(Education, Physical_Health, Sex) %>%
  # Rename variables to simplify axes and legends
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  mutate(Physical_Health = str_replace(Physical_Health, "0", "0 days")) %>%
  mutate(Physical_Health = str_replace(Physical_Health, "1", "0-13 days")) %>%
  mutate(Physical_Health = str_replace(Physical_Health, "2", "14+ days")) %>%
  mutate(Physical_Health = factor(Physical_Health, levels=c("0 days", "0-13 days", "14+ days"))) %>%
  mutate(Sex = str_replace(Sex, "1", "Male")) %>%
  mutate(Sex = str_replace(Sex, "2", "Female")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "0", "No Diabetes")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "1", "Type 2 Diabetes")) %>%
  mutate(Count = n())
# Create plot comparing Education, Sex, and Physical_Health
ggplot(df_summary, aes(x = Education, y = Physical_Health, size=Count, color=Count)) +             
  geom_point() +
  facet_wrap(~Sex) +
  coord_flip() + 
  ylab("Days with Poor Physical Health") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

### Plots to compare relationship between Type 2 Diabetes and Kidney Disease
#### Different size dots for different counts (use to see if there is a relationship between the two variables)
```{r}
df_summary <- CDC_2023_subset %>%                                                                 
  group_by(Type_2_Diabetes, Kidney_Disease, Sex) %>%
  # Rename variables to simplify axes and legends
  mutate(Education = str_replace(Education, "1", "Never attended school or only attended kindergarten")) %>%
  mutate(Education = str_replace(Education, "2", "Grades 1 through 8 (Elementary)")) %>%
  mutate(Education = str_replace(Education, "3", "Grades 9 through 11 (Some high school)")) %>%
  mutate(Education = str_replace(Education, "4", "Grade 12 or GED (High school graduate)")) %>%
  mutate(Education = str_replace(Education, "5", "College 1 to 3 years (Some college or technical school)")) %>%
  mutate(Education = str_replace(Education, "6", "College 4 years or more (College graduate)")) %>%
  mutate(Education = factor(Education, levels=c("Never attended school or only attended kindergarten", "Grades 1 through 8 (Elementary)", "Grades 9 through 11 (Some high school)", "Grade 12 or GED (High school graduate)", "College 1 to 3 years (Some college or technical school)", "College 4 years or more (College graduate)"))) %>%
  mutate(Employment_Status = str_replace(Employment_Status, "1", "Employed")) %>%
  mutate(Employment_Status = str_replace(Employment_Status, "2", "Out of Labor Force")) %>%
  mutate(Employment_Status = str_replace(Employment_Status, "3", "Unemployed")) %>%
  mutate(Income = str_replace(Income, "1", "Less than $10,000")) %>%
  mutate(Income = str_replace(Income, "2", "$10,000 to <$15,000")) %>%
  mutate(Income = str_replace(Income, "3", "$15,000 to <$20,000")) %>%
  mutate(Income = str_replace(Income, "4", "$20,000 to <$25,000")) %>%
  mutate(Income = str_replace(Income, "5", "$25,000 to <$35,000")) %>%
  mutate(Income = str_replace(Income, "6", "$35,000 to <$50,000")) %>%
  mutate(Income = str_replace(Income, "7", "$50,000 to <$75,000")) %>%
  mutate(Income = str_replace(Income, "8", "$75,000 to < $100,000")) %>%
  mutate(Income = str_replace(Income, "9", "$100,000 to <$150,000")) %>%
  mutate(Income = str_replace(Income, "10", "$150,000 to <$200,000")) %>%
  mutate(Income = str_replace(Income, "11", "$200,000 or more")) %>%
  mutate(Sex = str_replace(Sex, "1", "Male")) %>%
  mutate(Sex = str_replace(Sex, "2", "Female")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "0", "No Diabetes")) %>%
  mutate(Type_2_Diabetes = str_replace(Type_2_Diabetes, "1", "Type 2 Diabetes")) %>%
  mutate(Kidney_Disease = str_replace(Kidney_Disease, "1", "Yes")) %>%
  mutate(Kidney_Disease = str_replace(Kidney_Disease, "2", "No")) %>%
  summarise(n = n()) %>%
  mutate(freq = n / sum(n))
# Create plot comparing Type_2_Diabetes, Sex, and Kidney_Disease
ggplot(df_summary, aes(x = Type_2_Diabetes, y = Kidney_Disease, size=freq, color=freq)) +             
  geom_point() +
  facet_wrap(~Sex) +
  coord_flip() + 
  xlab("Type 2 Diabetes") +
  ylab("Kidney Disease") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```